document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("process-text");e?e.addEventListener("click",(async()=>{console.log("ğŸŸ¢ Button clicked! Running text extraction & screenshot capture...");try{const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!e)return void console.error("âŒ No active tab found.");console.log(`ğŸ“Œ Using active tab ID: ${e.id}`),await chrome.scripting.executeScript({target:{tabId:e.id},files:["dist/contentScript.bundle.js"]}),console.log("âœ… Content script injected successfully."),await new Promise(((o,t)=>{chrome.tabs.sendMessage(e.id,{type:"RUN_LOGIC"},(e=>{chrome.runtime.lastError?(console.error("âŒ AI error:",chrome.runtime.lastError.message),t(chrome.runtime.lastError.message)):e&&"done"===e.status?(console.log("ğŸ¤– AI Response:",e.aiResponse),o(e.aiResponse)):(console.error("âŒ Unexpected AI response:",e),t("Unexpected AI response"))}))})),chrome.runtime.sendMessage({type:"START_FULL_PAGE_CAPTURE",tabId:e.id},(e=>{console.log("ğŸ“¥ Full-page capture started:",e)}))}catch(e){console.error("âŒ Error:",e)}})):console.error("âŒ Button not found! Check popup.html.")})),chrome.runtime.onMessage.addListener(((e,o,t)=>{"SCREENSHOTS_READY"===e.type&&(console.log("ğŸ“¸ Full-page screenshots received:",e.images),e.images.forEach(((e,o)=>{console.log(`ğŸ–¼ï¸ Screenshot #${o+1}:`,e)})),t({status:"received"}))}));